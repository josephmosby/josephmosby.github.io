<!doctype html>
<html>
	<head>

		<title>josephmosby.com</title>
		<meta http-equiv="Content-Type" content="text/html" charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" href="/stylesheets/fibonacci.css" />
		<link rel="stylesheet" href="/stylesheets/custom.css" />

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

	</head>

	<body>

		<div class="wrapper" id="header">
			<div class="container">
				<div class="row">
					<div class="col-13">
						<a href="/"><h3>JOSEPH MOSBY</h3></a>

						<ul class="menu inline">
							<li><a href="/about">about</a></li>
							<li><a href="/projects">projects</a></li>
							<li><a href="/presentations">presentations</a></li>
							<li><a href="/now">now</a></li>
							<li><a href="/feed/atom.xml">subscribe</a></li>
						</ul>

						<a id="hamburger" href="#">MENU</a>
					</div>
				</div>
			</div>
		</div>

		<div class="wrapper" id="dropdown">
			<div class="container">
				<div class="row">
					<div class="col-13">
						<ul class="menu dropdown">
							<li><a href="/about">about</a></li>
							<li><a href="/projects">projects</a></li>
							<li><a href="/presentations">presentations</a></li>
							<li><a href="/now">now</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>

		<div class="wrapper" id="main">
			<div class="container">
				
<div class="row">
	<div class="col-3">
		<a href="/2014/04/12/choosing-a-development-platform-to-reach-the-right-users.html"><h3>Choosing a Game Development Platform to Reach the Right Users</h3></a>
		<div class="date">April 12, 2014</div>
	</div>
	<div class="col-8">
		<p>Last Friday, I attended the <a href="http://www.media4socialimpact.org/">Media for Social Impact</a> Summit at the United Nations headquarters in NYC. Aside from the awesomeness of attending a conference at the United Nations, the summit was a really enlightening experience crammed into a single day’s worth of sessions. Each group of panelists focused on the most effective way to run an issue-based campaign with a social change in mind on a particular type of media. Of particular interest to me was the talk by Asi Burak of <a href="http://www.gamesforchange.org/">Games for Change</a>, whose <a href="https://www.facebook.com/HalftheGame">Half the Sky</a> game was designed to raise funds to empower women and girls.</p>

<p>Half the Sky is a Facebook game, a medium that I had admittedly often dismissed due to FarmVille and the like. I knew there were a ton of players on Facebook - 40 million monthly active users on Facebook for Farmville 2, <a href="http://www.polygon.com/2013/1/4/3837236/farmville-2-infographic-40-million-monthly-active-users">for example</a> - but really, why would I consider Facebook when there’s so much interesting stuff to be done on Steam or Xbox Live? Why would I tie my game to the constraints of a web browser when I could harness the entire power of a computer instead? </p>

<p>I had forgotten an extremely critical thing for a game of this nature. This was not a typical game that wanted its hands on every single possible user, but a game with a specific theme that needed to target a particular type of user. This game was designed to empower women and girls, and thus it needed to be on a platform that had a lot of women and girls playing games. That platform isn’t Xbox Live, or Steam, or PS3.. it’s Facebook. This game needed to reach a target audience at the lowest possible cost, and that meant Facebook development.</p>

<p>This was jaw-dropping for me as a developer who had never considered aligning the users I thought would be most interested in my game with the platform where those users hung out. And I’d also forgotten that the type of game (whether it’s strategy, turn-based, shooter, etc., etc.) is also going to be important to attract a certain type of audience. Let’s take a look at some examples:</p>

<h3 id="i-want-to-target-women-between-the-ages-of-35-and-50">I Want to Target Women Between the Ages of 35 and 50</h3>

<p>According to research by <a href="http://blog.apptopia.com/game-demographics-that-every-developer-should-know/">Apptopia and Flurry Analytics</a>, you need to take a look at slot machines or a “social turn-based” game (think FarmVille) if you want a game that’s going to appeal to women between the ages of 35 and 50. Think back to every time you’ve walked through a casino and wondered who actually played all of those slot machines - if you saw customers, they were likely right in that demographic. And you might consider a Facebook game - <a href="https://www.mediabistro.com/alltwitter/social-media-user-demographics_b38095">72% of female U.S. Internet users are on Facebook</a> - and you’re likely going to want to promote it on Pinterest as well. Go after ad partners who are targeting this demographic and show them the numbers.</p>

<h3 id="i-want-to-target-men-between-the-ages-of-20-and-30">I Want to Target Men Between the Ages of 20 and 30</h3>

<p>Let’s go back to that <a href="http://blog.apptopia.com/game-demographics-that-every-developer-should-know/">Apptopia piece</a>. You’re talking shooter games, RPGs, strategy games. If it’s an absolute requirement that you have regular return visitors, you need to put that strategy cap on.. but if you can get by with casual players, go for the shooters instead. You know that Pinterest isn’t worth your promotional efforts, but Twitter might be. And given the type of games that are popular on Steam (shooters, RPGs, and strategy), you certainly might want to take a look at launching there to promote to a heavily male audience. </p>

<p>None of this is an exact science, of course. You’ve still got to make a quality game and promote it the right way for it to take off. But you’re going to start off behind if you don’t take these things into consideration, and after developing a game for months at a time - you definitely don’t want to flop because you chose the wrong place to put your game.</p>

<p>TL;DR:</p>

<p><img src="/images/badtime.jpg" alt="If you promote a first person shooter on Pinterest, you're gonna have a bad time" /></p>

		<a class="twitter-share-button" href="http://twitter.com/share" data-url="http://josephmosby.com/2014/04/12/choosing-a-development-platform-to-reach-the-right-users.html" data-via="josephmosby">Tweet</a>
	</div>
</div>

<div class="row">
	<div class="col-3">
		<a href="/2014/04/03/playlist-choices-for-the-month-of-april.html"><h3>Playlist Choices for the Month of April</h3></a>
		<div class="date">April 03, 2014</div>
	</div>
	<div class="col-8">
		<p>Every month, I start a brand new playlist that I fill with music over the course of the month. By the end of the first week, I share out what I’ve got so far. I’ve currently got Avicii’s “Hey Brother” stuck in my head and my playlist starts with that in mind. You’ll see some of both the EDM and old country/blues influences in this mix. </p>

<ol>
  <li>Lyle Lovett - “I Will Rise Up / Ain’t No More Cane”</li>
  <li>Avicii - “Hey Brother”</li>
  <li>Robert Randolph &amp; the Family Band - “Going in the Right Direction”</li>
  <li>The Delta Saints - “Company of Thieves”</li>
  <li>Eric Clapton and B.B. King - “Riding with the King”</li>
  <li>Pharrell Williams - “Happy”</li>
  <li>Cage the Elephant - “Ain’t No Rest for the Wicked”</li>
  <li>Eisley - “Marvelous Things”</li>
  <li>The 1975 - “Chocolate”</li>
  <li>Bastille - “Pompeii (Audien Remix)”</li>
  <li>Gorillaz - “Feel Good Inc.”</li>
  <li>Calvin Harris - “Summer”</li>
  <li>Gareth Emery &amp; Krewella - “Lights &amp; Thunder”</li>
</ol>

<p><a href="http://open.spotify.com/user/josephmosby/playlist/3CkL8xxAW7n7SYmOHg61jc">April 2014 - Spotify playlist</a></p>

		<a class="twitter-share-button" href="http://twitter.com/share" data-url="http://josephmosby.com/2014/04/03/playlist-choices-for-the-month-of-april.html" data-via="josephmosby">Tweet</a>
	</div>
</div>

<div class="row">
	<div class="col-3">
		<a href="/2014/04/03/hacking-confirmation-emails-on-the-fly-with-mailgun.html"><h3>Hacking Confirmation Emails on the Fly with Mailgun</h3></a>
		<div class="date">April 03, 2014</div>
	</div>
	<div class="col-8">
		<p>I just finished slinging together some code for a confirmation email system for an email advocacy campaign using <a href="http://corporate.cqrollcall.com/cqrcengage">CQRC Engage</a>. Engage has a fairly simple set of tricks: it provides you with a Javascript-based widget to write a letter to your legislators, then submits that letter through whichever digital channel the legislator uses. As part of its process, it runs a check to find your particular legislator based on street address and postal code, then tailors the messages for that particular person. Engage doesn’t have an email confirmation sent to you as part of your advocacy, so I built one.</p>

<p>Engage accepts letter submissions via that Javascript widget, then stores data about that advocate, the target, and the message itself in a database accessible via an API. This is all we need to begin constructing our confirmation email system. We’re going to use <a href="http://www.mailgun.com">Mailgun</a> for this task, which is an API-based system that accepts HTTP POST requests and turns them into emails at your command. Without further ado, let’s start building.</p>

<p>I’m first going to build out a series of tiny classes that I’ll use to power my app. In this case, we’ll need four: one for the Advocate who sent a message, one for the Target, one for the Sent Message, and one for the Confirmation Email. They look something like this:</p>

<p>```python
class Advocate:
	def <strong>init</strong>(self, first_name, last_name, email):
		self.first_name = first_name
		self.last_name = last_name
		self.email = email</p>

<p>class Target:
	def <strong>init</strong>(self, first_name, last_name, title):
		self.first_name = first_name
		self.last_name = last_name
		self.title = title</p>

<p>class SentMessage:
	def <strong>init</strong>(self, sender, recipients, message_subject, message_text):
		self.sender = sender # who should be an Advocate
		self.recipients = recipients # a list of Targets
		self.message_subject = message_subject
		self.message_text = message_text</p>

<p>class ConfirmationEmail:
	def <strong>init</strong>(self, sent_message):
		self.message_sent = sent_message
```</p>

<p>This is all stuff I’m going to extract from Engage without any further processing. I’m also going to go ahead and construct my confirmation email template using Jinja’s syntax, which will accept data from these classes you see above.</p>

<p>```</p>
<html>
	<head>
		<meta charset="UTF-8" />
	</head>
	<body>
		<p>Dear {{ first_name }} {{ last_name }}:</p>
		
		<p>{{ confirmation_leadin }}</p>
		
		{% for recipient in recipients  %}
			{{ recipient.first_name }} {{ recipient.last_name }}, {{ recipient.title }}
			<br />
		{% endfor %}
		
		<br />
		
		<p>SUBJECT: {{ message_subject }}</p>
		
		{{ message_text }}
	</body>
</html>
<p>```</p>

<p>So far so good. You can see here that we’ve got a “confirmation_leadin” variable that doesn’t seem to line up with any of our other tags. We added some introductory text into our emails as a “thank you” before including the text of the message and the list of targets it was sent to. Next step is to add on some basic work to begin converting the plain text messages out of Engage into HTML-based messages using <a href="https://pythonhosted.org/Markdown/reference.html">Markdown</a>. Then we’ll use that, along with some of the data from our classes, to populate our Jinja template.</p>

<p>```python
# other lines truncated for brevity
class ConfirmationEmail: 
	def <strong>init</strong>(self, sent_message):
		self.message_sent = sent_message
		self.sanitized_message = markdown.markdown(sent_message.message_text, safe_mode=’replace’)</p>

<pre><code>def create_confirmation_text(self):
	self.confirmation_message = template.render( 
								{"first_name" : self.message_sent.sender.first_name,
							   	"last_name" : self.message_sent.sender.last_name, 
							   	"targets" : self.message_sent.recipients,
							   	"confirmation_leadin" : CONFIRMATION_LEADIN,
							   	"message_subject" : self.message_sent.message_subject,
							   	"message_text" : self.sanitized_message}) ```
</code></pre>

<p>We’re almost there! But now we just need to actually fire off that email, which requires a simple HTTP request using the <a href="http://docs.python-requests.org/en/latest/">requests</a> library.</p>

<p>```python
# other lines truncated for brevity
class ConfirmationEmail: 
	def <strong>init</strong>(self, sent_message):
		self.message_sent = sent_message
		self.sanitized_message = markdown.markdown(sent_message.message_text, safe_mode=’replace’)</p>

<pre><code>def create_confirmation_text(self):
	self.confirmation_message = template.render( 
								{"first_name" : self.message_sent.sender.first_name,
							   	"last_name" : self.message_sent.sender.last_name, 
							   	"targets" : self.message_sent.recipients,
							   	"confirmation_leadin" : CONFIRMATION_LEADIN,
							   	"message_subject" : self.message_sent.message_subject,
							   	"message_text" : self.sanitized_message})

def send_confirmation_message(self):
	return requests.post(MAILGUN_DOMAIN, auth=("api",API_KEY), 
							data={"from": DEFAULT_SENDER,
								  "to": [self.message_sent.sender.email],
								  "subject": CONFIRMATION_SUBJECT,
								  "html": self.confirmation_message}) ```
</code></pre>

<p>We need one final bit to tie it all together - our script that checks the Engage system for new messages, downloads the data and then generates email templates out of it. I’m using pseudocode for some of the Engage API calls, but you’ll get the general idea.</p>

<p>```python
if <strong>name</strong> == “<strong>main</strong>”:
	token = cq.login(‘user’,’password’)
	actions = getActions(token)</p>

<pre><code># store Actions to our owned database
# the StoreActions formula was all written to check for anything already in the database and filter out those results

conn = db.connect('db-location')	
storeActions(conn, actions)

# now we retrieve unconfirmed actions
# this returns me a dictionary in the format { advocateId: {messageId: X, targets: [Y, Z, ...]}}  

unconfirmed = cq.retrieveAllUnconfirmed(conn)

for advocateId in unconfirmed.keys():
	advocate = cq.getAdvocate(token, advocateId)
	sender = Advocate(first_name = advocate["first_name"], last_name = advocate["last_name"], email = advocate["email"])
	recipients = []
	for targetId in unconfirmed[advocateId]["targets"]:
		target = cq.getTarget(token, targetId)
		recipients.append(Target(first_name = target["first_name"], last_name = target["last_name"], title = target["title"]))
	
	message_delivered = cq.getMessage(token, unconfirmed[advocateId]["messageId"])
	sent_message = SentMessage(sender = sender, recipients = recipients, message_subject = message_delivered["message_subject"], message_text = message_delivered["message_body"])
	
	confirmation_email = ConfirmationEmail(sent_message)
	confirmation_email.create_confirmation_text()
	
	confirmation_email.send_confirmation_email()
 
# then finally, mark those as confirmed in our database

cq.markAsConfirmed(conn, unconfirmed.keys())
</code></pre>

<p>And that’s it. We’ve built out a confirmation email system using Python - not very pretty, but it sure knows how to get the job done. Our final task is to run this puppy on a schedule using cron:</p>

<p><code>$ env EDITOR=nano crontab -e</code></p>

<p><code>
*/3 * * * * /path/to/your/script
</code></p>

<p>That will set up a cron job that runs every 3 minutes and executes our confirmation email script. We’re ready to run this live, and – barring anything catastrophic like a server crash – it’s relatively error proof. The script is designed to just fail silently and re-open every session if a script can’t finish execution, so if a script misfires we’ll just pick up those confirmation emails in the next batch three minutes later.</p>

<p>I’m a Mailgun convert after this. It’s perfect for setting up simple email messages and automating them. The fact that I hacked this together in a few hours with most of that time dedicated to parsing through Engage’s API documentation shows the ease of Mailgun’s system. I’m all for it.</p>

		<a class="twitter-share-button" href="http://twitter.com/share" data-url="http://josephmosby.com/2014/04/03/hacking-confirmation-emails-on-the-fly-with-mailgun.html" data-via="josephmosby">Tweet</a>
	</div>
</div>

<div class="row">
	<div class="col-3">
		<a href="/2014/03/31/creating-a-mobile-app.html"><h3>Creating a Mobile Content App with (Almost) Real Time Edits</h3></a>
		<div class="date">March 31, 2014</div>
	</div>
	<div class="col-8">
		<p>It’s not too often that we’re asked to put together a native mobile app at <a href="http://www.apcoworldwide.com">APCO Worldwide</a>, but it does happen from time to time. We’re a communications firm first and an app development firm second, and that means we have to plan for regular content additions, modifications and deletions that often need to happen immediately. We can’t afford to recompile code and go through an app submission process every time someone needs to add a new story to an app, so we have to bake some flexibility into the system itself.</p>

<p>We also like to give our communications teams (copywriters, speechwriters, etc.) the ability to edit their own content on the fly when they need to. It’s certainly easier for all parties concerned. Content changes don’t have to be worked into a development queue, and developers don’t need to go through the same quality control cycles over and over again if we build something flexible from the start. To this end, we’ve often opted to use Drupal for our CMS. We’ve trained our communications teams on how to use it and now have a predictable development pattern for the sites we build to deal with similar use cases. It gets hacky from time to time, but it works for a PR firm. </p>

<p>One of our comms teams came to us in January with a content rich app idea that needed to be native on both iOS and Android. We knew it would require regular updates with a minimum amount of fuss, so we needed to find a way to feed content to the app rather than store it all locally. We also needed the application that populated that feed to have an interface that was familiar to our communications team. We knew we could solve the second problem with either Drupal or Wordpress, but what to do with the first?</p>

<p>Enter one of my new favorite ways to spend taxpayer money: the Drupal <a href="https://drupal.org/project/contentapi">Content API</a> module. This project was put together jointly by the Federal Communications Commission and <a href="http://seabourneinc.com/">Seabourne Consulting</a>, and it does exactly what it sounds like: it makes a content API out of your Drupal website. There’s a nice point-and-click interface in the Drupal administrative console that allows you to select the content types you’d like to feature in your API, the endpoints you’d like to use, and the fields you’d like to include, then voilà - an XML-formatted API appears. It’s beautiful.</p>

<p>So we’ve now got a nice XML feed of all of the content that’s going to populate this app happily displayed out there on the web. Our users can add, delete and modify entries and the XML feed will automatically update. </p>

<p>Getting this data into the app was another story altogether. We followed these rough steps to build our system on both iOS and Android:
1. Connect to the API 
2. Download the main XML file, which lists all content 
3. Parse the XML file and check the IDs against our existing data present on the phone
4. Download any new or modified IDs
5. Lay out app for user content viewing</p>

<p>And that’s pretty much it. I won’t go into a detailed tutorial - I leaned heavily on another developer for much of the native app work - but I will share a few gotchas.</p>

<p>The Content API module takes a non-configurable approach to pagination. In the standard code, you get ten items per XML page, and that’s it. I understand the rationale for why a government-sponsored content API would want to be careful on how much data it allowed out at any one time, but that wasn’t going to work for this project. Around line 500 in <code>contentapi.module</code>, one finds the following code snippet:</p>

<p><code>php
$limit = (isset($_GET['limit'])) ? (integer)$_GET['limit'] : 10;
...
$limit_cap = variable_get('contentapi_limit', 10);
</code></p>

<p>Change those 10’s to 200’s and now we’re talking. I am ashamed of the inelegance of this hack, but it got the job done.</p>

<p>Our second headache was XML parsing on Android. When we had the first working build up and running, it took five minutes to download the initial feed on a new installation. Android does a great job of background task management, but five minutes for a set of downloads that were mostly text was unacceptable. We did our homework, and it turns out that the <a href="http://steveliles.github.io/comparing_java_xml_parsing_mechanisms_for_android.html">standard approaches for XML parsing are absolute garbage on Android</a>. As <a href="http://twitter.com/steveliles">Steve Liles</a> points out in the above post, it’s far more efficient to swap in Java’s SAX parser to manage your XML downloads. We got our full download time to about a minute - and given that we were also having to deal with PDFs and images, I’ll take it. </p>

<p>We had a lot of fun building this app and thinking through how to make it play nicely on multiple devices with an easy-to-use central administration console. We’d love for you to take a look at our <a href="https://play.google.com/store/apps/details?id=com.meetingsmeanbusiness.mmb">Android handiwork</a>. I’ll share the iOS version once it finishes the Apple review cycle. Enjoy!</p>

		<a class="twitter-share-button" href="http://twitter.com/share" data-url="http://josephmosby.com/2014/03/31/creating-a-mobile-app.html" data-via="josephmosby">Tweet</a>
	</div>
</div>

<div class="row">
	<div class="col-3">
		<a href="/2014/03/26/open-source-search-technologies-for-human-beings-part-3.html"><h3>Open Source Search Technologies for Human Beings - Part 3</h3></a>
		<div class="date">March 26, 2014</div>
	</div>
	<div class="col-8">
		<p>In the <a href="http://josephmosby.com/2014/03/24/open-source-search-technologies-for-human-beings-part-1.html">first part</a> of this series, we talked about the nuts and bolts of search engines: how they create a nicely organized index of keywords and documents and use that index to find documents containing keywords. <a href="http://josephmosby.com/2014/03/25/open-source-search-technologies-for-human-beings-part-2.html">Part 2</a> walked us through Lucene, an open source search engine written in Java that turns our Part 1 idea of a search engine into a computer program. With Part 3, we’re going to build upon Lucene with Solr and Elasticsearch, two programs that use Lucene to create a fully-featured web search engine.</p>

<p>We saw that Lucene can do some basic indexing and searching, but it’s fairly limited. It can only handle plain text documents well, it doesn’t have any ability to connect to the web, and even the tiny little command-line application we used to “talk” to Lucene had to be built as a demonstration. Needless to say, Lucene just doesn’t have what we need to serve as a web search engine. That’s where Solr and Elasticsearch come in. They use Lucene as their core, but they tack on additional features in different ways to meet the needs of their customers. We’ll take a first look at Solr, the federal government’s legacy search engine, then follow it by showing the future with Elasticsearch.</p>

<h3 id="solr">Solr</h3>

<p><a href="https://lucene.apache.org/solr/">Solr</a> began as an enterprise search engine in 2004, and was designed for websites from the beginning. It was initially part of the closed source code owned by CNET, but was released as open source software when CNET donated the code to the Apache Software Foundation a a few years later. Solr has since become an integral part of the Lucene ecosystem to the point that the two programs are now maintained by the same development team. </p>

<p>Solr runs as an application server. Any program making use of a Solr server must make some sort of request to the server (such as adding documents to be indexed or querying for documents with “football” in the text). Solr will then respond to that request with search results, which the program can then display to the user, load into a web page or incorporate into a larger application. </p>

<p><img src="/images/solr_doc_1.png" alt="Diagram of a program adding a file to the Solr index" /></p>

<p>The popularity of Solr for years brought it a lot of support from developer communities across many different languages and platforms. Solr proudly boasts support for PHP, Ruby, Python, Drupal, Wordpress, and a stack of other platforms that make adoption easy for users regardless of their existing technology stack. It’s fast to set up, fast to run, and easy for an administrator to maintain through a web-based administrative interface.</p>

<p>That being said, Solr has a stack of limitations. It began as a centralized Java application, and it still requires a lot of familiarity with Java to run effectively. And all the Java in the world can’t make up for the fact that Solr was built to be run from a central location. Elasticsearch took a different approach.</p>

<h3 id="elasticsearch">Elasticsearch</h3>

<p><a href="http://www.elasticsearch.org/">Elasticsearch</a> is the new kid on the block of open source search engines. <a href="https://twitter.com/kimchy">Shay Baron</a> started writing the roots of Elasticsearch in 2004 with the Compass project, but soon realized that he would have to rewrite Compass to build it into a fully “scalable” system that could handle a substantial amount of search traffic at once without crashing. In 2010, Compass was rolled into the Elasticsearch project with all of the features needed to challenge Solr’s dominance.</p>

<p>Elasticsearch (which I’ll just abbreviate as ES from now on) was built from the ground up to be a distributed search platform rather than a centralized system like Solr. Whereas Solr has to handle each search request from a central hub, ES can split the workload over a cluster of search servers to speed up processing. Search starting to run slowly? Add more servers, no problem.</p>

<p><img src="/images/es_doc_1.png" alt="Diagram of a program adding a file to the Elasticsearch index, which consists of many servers" /></p>

<p>To be fair, Solr is now technically a distributed system as well through the addition of <a href="http://zookeeper.apache.org/">Zookeeper</a>. Zookeeper is a program designed to keep multiple servers in synchronization as a single Solr instance. It’s an afterthought, though, and Solr still is not capable of handling many of the advanced distribution features that ES boasts by default. </p>

<p>Elasticsearch also allows programmers to interact with a single RESTful API when they want to update and query the search engine. This is incredibly attractive to the average web developer who often did not study Java programming in school but interacts with RESTful APIs on a daily basis. With a single tailored request sent to ES’ API, developers have search results ready to go without the need for a full-featured Java application.</p>

<p>Modern search engines also have a specific syntax for creating complex queries (for example, typing “site:apache.org Solr” will return any results for Solr on the Apache website only), and Elasticsearch is no different. The search engine also comes with a stack of plugins available and programming libraries written for many of the more esoteric languages to complement the common options available to both ES and Solr developers.</p>

<h3 id="conclusion">Conclusion</h3>

<p>Elasticsearch offers a number of benefits to web developers, and it’s easy to see why the federal government is making moves to convert Solr instances into Elasticsearch ones. RESTful APIs and distributed clusters simply make perfect sense in a web environment. I’ll be looking forward to seeing continued improvements in the federal government’s search capabilities as they work through the upgrade.</p>

<p>– special thanks to Kelvin Tan’s great side-by-side breakdown of the technical differences between Solr and Elasticsearch here: <a href="http://solr-vs-elasticsearch.com/">http://solr-vs-elasticsearch.com/</a></p>

		<a class="twitter-share-button" href="http://twitter.com/share" data-url="http://josephmosby.com/2014/03/26/open-source-search-technologies-for-human-beings-part-3.html" data-via="josephmosby">Tweet</a>
	</div>
</div>

<div class="row">
	<div class="col-3">
		<a href="/2014/03/25/open-source-search-technologies-for-human-beings-part-2.html"><h3>Open Source Search Technologies for Human Beings - Part 2</h3></a>
		<div class="date">March 25, 2014</div>
	</div>
	<div class="col-8">
		<p>In the <a href="http://josephmosby.com/2014/03/24/open-source-search-technologies-for-human-beings-part-1.html">first part</a> of this series, we investigated the basics of how a search engine theoretically works. The process we described in part 1 didn’t actually require a computer at all - any person could theoretically follow those exact same steps. Indeed, writers of complex research materials did so for decades before the first computers were invented. </p>

<p>Though there is an entire profession based strictly around organizing and categorizing information and retrieving it at a later time (librarians), the average person doesn’t want to be doing that on a daily basis. We’ve got computers for that, but that means we have to write a program to perform all of those steps we don’t want to do ourselves. This brings us to <a href="https://lucene.apache.org/core/">Lucene</a>.</p>

<h3 id="lucene">Lucene</h3>

<p>To quote exactly from the official manual: “Lucene is a high-performance, full-featured text search engine library written entirely in Java.” Lucene performs all of the search engine features we described in part 1: it reads text-based documents, creates an index of those documents, and retrieves the documents based on search keywords. It does this quickly and efficiently with many features that make it appealing to computer programmers who wish to incorporate it into their applications. </p>

<p>Let’s take a quick tour of Lucene by playing around with its demo directly. </p>

<pre><code>java org.apache.lucene.demo.IndexFiles /{path}/lucene-4.7.0/licenses
</code></pre>

<p>With this command, we first call the Java available on most of our personal computers. Lucene is written entirely in Java, a programming language popular with the federal government and many large commercial enterprises. We then call a Java-specific Lucene command - IndexFiles - and ask Lucene to index all the files in the “licenses” directory. This will produce an index of all of the legal software license documents that apply to the use of Lucene. When we do this, Lucene will happily print out a stack of messages letting us know that it’s indexing:</p>

<p><code>
Indexing to directory 'index'...
adding /{path}/lucene-4.7.0/licenses/ant-1.8.2.jar.sha1
adding /{path}/lucene-4.7.0/licenses/ant-LICENSE-ASL.txt
adding /{path}/lucene-4.7.0/licenses/ant-NOTICE.txt
... so on and so forth...
</code></p>

<p>And now we have an index! Let’s query it for a search term:</p>

<p><code>
java org.apache.lucene.demo.SearchFiles
Enter query: 
GNU
Searching for: gnu
2 total matching documents
1. /{path}/lucene-4.7.0/licenses/javax.servlet-LICENSE-CDDL.txt
2. /{path}/lucene-4.7.0/licenses/servlet-api-LICENSE-CDDL.txt
</code></p>

<p>I entered the SearchFiles command, and Lucene immediately prompted me for a search term. Thinking that I might find some reference to the <a href="https://www.gnu.org/copyleft/gpl.html">GNU Public License</a> in a piece of open source software, I typed in “GNU” as my search term. Lucene found two files that contain the word “GNU” and returned them to me here. But if I try another term, it finds nothing at all:</p>

<p><code>
java org.apache.lucene.demo.SearchFiles
Enter query: 
football
Searching for: football
0 total matching documents
</code></p>

<p>There’s a lot going on behind the scenes here with even this tiny demo app, but the basics are quite simple. Lucene has followed the exact same process for indexing and searching that we described in part 1. But what if we need to parse through an HTML or Word document rather than a simple text document? We’ll need something a little bit more robust, which is where Solr and Elasticsearch come in… in <a href="http://josephmosby.com/2014/03/25/open-source-search-technologies-for-human-beings-part-3.html">part 3</a>. </p>

		<a class="twitter-share-button" href="http://twitter.com/share" data-url="http://josephmosby.com/2014/03/25/open-source-search-technologies-for-human-beings-part-2.html" data-via="josephmosby">Tweet</a>
	</div>
</div>

<div class="row">
	<div class="col-3">
		<a href="/2014/03/24/open-source-search-technologies-for-human-beings-part-1.html"><h3>Open Source Search Technologies for Human Beings - Part 1</h3></a>
		<div class="date">March 24, 2014</div>
	</div>
	<div class="col-8">
		<p>Search is one of those features that’s become so “baked in” to the way we experience the web that it’s often an afterthought for us as users. We peck a few well-chosen words into the Google search bar, press enter, and end up where we needed to be. It’s become a mental backup system to the point that we no longer even need to bookmark a link any more as long as we can remember the few keywords that will bring us back to the page. Though I develop websites every single day, I had never actually thought about the search technology that brings users to my page and allows them to find the content they wanted.</p>

<p>I was suddenly forced to confront my ignorance of search when I learned that the General Services Administration would be changing their search software from <a href="https://lucene.apache.org/solr/">Solr</a> to <a href="http://www.elasticsearch.org/">Elasticsearch</a>. Having no idea how either of them worked, I started doing my homework immediately. </p>

<h3 id="how-search-works">How Search Works</h3>

<p>Though the specific implementations vary across platforms, the core of any text-based search technology is the same. The subject matter will be broken down into small components that can be stored in an index that references back to the document in question. The name is not accidental: this works in the same way as a word index that points back to pages at the back of a heavy research book. As we add more documents to the index, this process is repeated and the index size and complexity increases. </p>

<p>In this example, our documents can be anything primarily composed of text. Web pages, Word documents or eBooks could all be comfortably fed into our search engine and happily indexed. Eventually, though, we’ll need to retrieve that information if we want a fully functional search engine. An index of extremely well-organized keywords and documents won’t do us any good if we never use it to retrieve the information we need. To do so, we’ll “query” the index by feeding it a keyword. The search engine will then check its index for all documents that match that keyword and return us the corresponding list of document. If we add more than one keyword, the search engine will query the index to find documents that show up for each individual keyword then compare the results to bring us documents that contain all of our keywords. </p>

<p>Let’s take a quick visual walk through this process. Say we have a document (NFL.doc) that we’d like to index. Our document contains quite a bit of text about the NFL, all of which will be broken down and inserted into our index.</p>

<p><img src="/images/NFLdoc.png" alt="Picture of a document that contains text about the NFL" /></p>

<p>Our indexing process is going to examine the text of the document, split out the words, and point those words back to NFL.doc.</p>

<p><img src="/images/index1.png" alt="Table of keywords that all correspond back to NFL.doc" /></p>

<p>We’ll then add these keyword/document pairings into our main index, which contains similar pairings for other documents.</p>

<p><img src="/images/index2.png" alt="Table of keyword/document pairings that contains NFL and MLS references" /></p>

<p>When a user searches for a term, the search engine will check the index and return the documents that correspond to that term. In this example, our user has searched for “football.”</p>

<p><img src="/images/search.png" alt="Input box prompting user to search. The user has entered &quot;football&quot; into the input box." /></p>

<p>Our example index only has a single entry for the word “football” - the NFL.doc document - and so our search engine returns that document to the user.</p>

<p><img src="/images/single_search_result.png" alt="Table showing a single keyword/document pairing that matches the word football with NFL.doc" /></p>

<p>And that’s the core of a search engine to get us started! In <a href="http://josephmosby.com/2014/03/25/open-source-search-technologies-for-human-beings-part-2.html">Part 2</a> I’ll talk a little bit about Lucene, the nuts and bolts of both Solr and Elasticsearch. In <a href="http://josephmosby.com/2014/03/25/open-source-search-technologies-for-human-beings-part-3.html">Part 3</a>, I’ll compare the two pieces of software to show how they each bring search technology to life for the web. </p>

		<a class="twitter-share-button" href="http://twitter.com/share" data-url="http://josephmosby.com/2014/03/24/open-source-search-technologies-for-human-beings-part-1.html" data-via="josephmosby">Tweet</a>
	</div>
</div>

<div class="row">
	<div class="col-3">
		<a href="/2014/03/18/buzztale-an-enterprise-story-sharing-platform.html"><h3>Buzztale&#58; An Enterprise Story-Sharing Platform</h3></a>
		<div class="date">March 18, 2014</div>
	</div>
	<div class="col-8">
		<p>Innovative corporate communications are difficult things to pull off well. If the company’s large enough, it probably comes saddled with a restrictive Microsoft suite of applications, including SharePoint, Outlook, and perhaps Yammer. Communicating to your employees is often done in the form of an email template with mostly text and a few pictures that’s brittle enough to restrict modification based on the type of event. Yammer freed things up enough to have a conversation, but you’re still locked into the Yammer style that looks like an ugly version of Twitter. Not fun at all.</p>

<p>I’ve been experimenting with <a href="http://www.buzztale.com">Buzztale</a> over the past few days as an alternative to the typical approach. Buzztale brands themselves as a tool for creating “Enterprise Story Networks” - think a collaborative version of Storify. Though the platform has a really slick desktop interface, it’s definitely geared toward mobile. Users can only create stories and add new items through the Buzztale mobile apps. </p>

<p>Buzztale has thought through their audience well. Each story comes pre-built with an embeddable widget like this one below:</p>

<div id="latte-24d471" style="width:510px;height:600px;margin:0 auto;">

</div>

<script src="http://buzztale.com/b969e0/24d471/embed.js" type="text/javascript">

</script>

<ol>
  <li>In the first frame, I easily joined Kate Jackson’s story to view her content and could have added my own.</li>
  <li>In the second, I took a screenshot of their well-designed mobile interface. </li>
  <li>I’ve added a nice picture here with a caption from my phone.</li>
  <li>In case you don’t want to post any visuals, you can just add straight up notes. There’s no character limit here, so you can type epistles if you like.</li>
  <li>You can also search for tweets, and add them to your stream. Buzztale actually requires that you search for a particular hashtag, assuming that you’d be creating this story to align with a topic or event.</li>
  <li>And, finally, another picture. </li>
</ol>

<p>Buzztale looks and feels fantastic, and I’d use it as event coverage without a second’s thought. However, it’s got a few things to add before I’d consider rolling it out as a major corporate communications platform.</p>

<ul>
  <li>Stories are public, and there’s no way to change that. If I have a story of a private event, it’s going to be out there for the world.</li>
  <li>I need more Twitter functionality - specifically, I’d like to add tweets from a particular account or @-replies to a user.</li>
  <li>I’d like to be able to add certain content from the desktop. The mobile version is perfect, but I also want to be able to upload pictures and type notes as well. </li>
  <li>Recap and “about this page” text boxes to introduce the story would be excellent. </li>
  <li>Customizable URLs. The story from the widget above can be found at <a href="http://www.buzztale.com/b969e0/24d471">http://www.buzztale.com/b969e0/24d471</a>. </li>
</ul>

<p>This team has a lot of potential, though, and I’m sure many of my requests are in their pipeline. They just signed their first big pilot customer in <a href="http://www.tele2.com">Tele2</a>, a European telecommunications provider, and have the backing of Europe’s <a href="http://www.seedcamp.com">Seedcamp</a> and <a href="http://www.startupsauna.com">Startup Sauna</a>. I’m excited to see where they go, and will look forward to my first event to put them to a live test.</p>

<p><a href="http://www.buzztale.com">Buzztale.com</a></p>

		<a class="twitter-share-button" href="http://twitter.com/share" data-url="http://josephmosby.com/2014/03/18/buzztale-an-enterprise-story-sharing-platform.html" data-via="josephmosby">Tweet</a>
	</div>
</div>

<div class="row">
	<div class="col-3">
		<a href="/2014/03/17/moving-breadcrumbs-in-drupal-7-with-omega.html"><h3>Moving Breadcrumbs in Drupal 7 with Omega</h3></a>
		<div class="date">March 17, 2014</div>
	</div>
	<div class="col-8">
		<p>I recently had a client site that required me to move my Drupal breadcrumbs from one Omega zone to another, and I was absolutely stumped on how to do it. After much hacking around with template files with no success, I finally stumbled upon <a href="http://www.webbykat.com/2012/09/moving-breadcrumbs-zone-content-region-content-omega-drupal-7">this post</a> by Katharine Ruhl (who I learned was a DC resident while writing this post, awesome) where she described moving her breadcrumbs from the content zone to the content region. I adapted her approach to move my breadcrumbs to a new zone entirely. </p>

<p>First things first - I’m assuming you’re running Drupal 7 with Omega 3.x, and this tutorial is from that vantage point. To get things started off, we dive into the default Omega theme folder and pull out the zone–content.tpl.php file. That file will look a lot like this:</p>

<p><code>php
&lt;?php if ($wrapper): ?&gt;&lt;div&lt;?php print $attributes; ?&gt;&gt;&lt;?php endif; ?&gt;  
  &lt;div&lt;?php print $content_attributes; ?&gt;&gt;    
    &lt;?php if ($breadcrumb): ?&gt;
      &lt;div id="breadcrumb" class="grid-&lt;?php print $columns; ?&gt;"&gt;&lt;?php print $breadcrumb; ?&gt;&lt;/div&gt;
    &lt;?php endif; ?&gt;    
    &lt;?php if ($messages): ?&gt;
      &lt;div id="messages" class="grid-&lt;?php print $columns; ?&gt;"&gt;&lt;?php print $messages; ?&gt;&lt;/div&gt;
    &lt;?php endif; ?&gt;
    &lt;?php print $content; ?&gt;
  &lt;/div&gt;
&lt;?php if ($wrapper): ?&gt;&lt;/div&gt;&lt;?php endif; ?&gt;
</code></p>

<p>Drop that folder into the templates folder of your new theme, but rename it zone–preface.tpl.php (substitute preface for the zone of your choosing, natch). This will alert the preface zone that it should expect breadcrumbs. Don’t be distracted by the <code>&lt;?php print $content; ?&gt;</code> statement - Drupal uses that <code>$content</code> variable for every zone, not just the content zone. </p>

<p>You’re going to need to strike the <code>$messages</code> section out of this, as we don’t need our Drupal error messages to pop up in two sections. Modify your new zone–preface.tpl.php file so it looks like this: </p>

<p><code>php
&lt;?php if ($wrapper): ?&gt;&lt;div&lt;?php print $attributes; ?&gt;&gt;&lt;?php endif; ?&gt;  
  &lt;div&lt;?php print $content_attributes; ?&gt;&gt;    
    &lt;?php if ($breadcrumb): ?&gt;
      &lt;div id="breadcrumb" class="grid-&lt;?php print $columns; ?&gt;"&gt;&lt;?php print $breadcrumb; ?&gt;&lt;/div&gt;
    &lt;?php endif; ?&gt;    
    &lt;?php print $content; ?&gt;
  &lt;/div&gt;
&lt;?php if ($wrapper): ?&gt;&lt;/div&gt;&lt;?php endif; ?&gt;
</code></p>

<p>Next, make a second copy of the zone–content.tpl.php file, place it in your theme’s template folder, but keep the name the same this time. We’re going to now strike the breadcrumb logic out of our new zone–content file so we don’t have double breadcrumbs. </p>

<p><code>php
&lt;?php if ($wrapper): ?&gt;&lt;div&lt;?php print $attributes; ?&gt;&gt;&lt;?php endif; ?&gt;  
  &lt;div&lt;?php print $content_attributes; ?&gt;&gt;     
    &lt;?php if ($messages): ?&gt;
      &lt;div id="messages" class="grid-&lt;?php print $columns; ?&gt;"&gt;&lt;?php print $messages; ?&gt;&lt;/div&gt;
    &lt;?php endif; ?&gt;
    &lt;?php print $content; ?&gt;
  &lt;/div&gt;
&lt;?php if ($wrapper): ?&gt;&lt;/div&gt;&lt;?php endif; ?&gt;
</code></p>

<p>And that’s all we need to do for the templates! We’ve now overridden two template files - the zone–preface file to add the breadcrumbs to that zone, and the zone–content file to remove them from that one. We diligently clear our caches, only to note that our breadcrumbs have totally disappeared and we’re now getting an “Undefined variable $breadcrumb” error at the top of our pages. </p>

<p>Omega appears to have the <code>$breadcrumb</code> variable hard-coded into the content zone, so we need to write an extra function to alert our <code>zone--preface.tpl.php</code> file to expect a <code>$breadcrumb</code>. Create a file in the preprocess folder of your theme and name it <code>preprocess-zone.inc</code>. Omega will see this as extra logic that it needs to incorporate before processing the theme. Type this function into that file:</p>

<p>```php
&lt;?php</p>

<p>function thisisyourthemename_alpha_preprocess_zone(&amp;$vars) {
	$theme = alpha_get_theme();</p>

<pre><code>if ($vars['zone'] == 'preface') {
	$vars['breadcrumb'] = $theme-&gt;page['breadcrumb'];
} }
</code></pre>

<p>?&gt;
```</p>

<p>The logic here is relatively straightforward. We declare a <code>$theme</code> variable that pulls in our existing theme data. We then add <code>'breadcrumb'</code> as a new variable within the theme - but only for the preface zone. </p>

<p>And that’s it! Clear your caches, save configuration and hit refresh. You’ll find that the breadcrumb trail is now happily appearing in your preface zone, ready to be styled however you like. </p>

		<a class="twitter-share-button" href="http://twitter.com/share" data-url="http://josephmosby.com/2014/03/17/moving-breadcrumbs-in-drupal-7-with-omega.html" data-via="josephmosby">Tweet</a>
	</div>
</div>


<div class="row">
	<div class="col-offset-3 col-8">
		<div class="pagination">
			
			<a href="/page7" class="previous">Previous</a>
			

			<span class="page_number">Page: 8 of 8</span>

			
			<span class="next">Next</span>
			
		</div>
	</div>
</div>
			</div>
		</div>

		<div class="wrapper" id="footer">
			<div class="container">
				<div class="row">
					<div class="col-13">
						<p>Brought to you live from Washington, D.C.</p>
					</div>
				</div>
			</div>
		</div>

		<script src="app.js"></script>

		<script>
	
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	    ga('create', 'UA-45638065-1', 'josephmosby.com');
	    ga('send', 'pageview');
	  
	  	</script>

  		<script>
		window.twttr=(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);t._e=[];t.ready=function(f){t._e.push(f);};return t;}(document,"script","twitter-wjs"));
		</script>

	</body>

</html>